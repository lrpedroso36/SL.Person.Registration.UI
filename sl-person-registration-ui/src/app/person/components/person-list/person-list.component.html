<div class="person-list">
  <div class="person-list__toolbar">
    <div class="person-list__toolbar__title">
      <h1 class="page-title">Cadastro de Pessoas</h1>
    </div>
    <div class="person-list__toolbar__action">
      <p-button icon="pi pi-plus" label="Novo" size="large" [routerLink]="['/person/registration/new']"/>
    </div>
  </div>
  <div class="person-list__content">
    <p-table [value]="items()" selectionMode="single" [(selection)]="selectedPerson" dataKey="documentNumber"
      (onRowSelect)="onRowSelect($event)" (onRowUnselect)="onRowUnselect($event)"
      [tableStyle]="{ 'min-width': '50rem' }" stripedRows [globalFilterFields]="['name', 'documentNumber']">
      <ng-template #header>
        <tr>
          <th>NOME</th>
          <th>DOCUMENTO</th>
          <th>TIPOS</th>
          <th></th>
        </tr>
        <tr>
          <th>
            <p-columnFilter type="text" field="name" placeholder="Filtro por nome" ariaLabel="Filtro por nome"
              matchMode="contains" filterOn="input"></p-columnFilter>
          </th>
          <th>
            <p-columnFilter type="text" field="documentNumber" placeholder="Filtro por documento"
              ariaLabel="Filtro por documento" filterOn="input" matchMode="contains"></p-columnFilter>
          </th>
          <th>
            <p-columnFilter type="text" field="types" placeholder="Filtro por tipo" ariaLabel="Filtro por tipo"
              filterOn="input" matchMode="contains"></p-columnFilter>
          </th>
          <th></th>
        </tr>
      </ng-template>
      <ng-template #body let-item>
        <tr [pSelectableRow]="item">
          <td>{{ item.name }}</td>
          <td>{{ item.documentNumber }}</td>
          <td>
            <ng-container *ngTemplateOutlet="personTypes; context: { $implicit: item }"></ng-container>
          </td>
          <td class="actions">
            <button pButton pTooltip="Visualizar" icon="pi pi-eye"
              class="p-button-rounded p-button-text p-button-info p-button-lg"></button>
            <button pButton pTooltip="Editar" icon="pi pi-pencil"
              class="p-button-rounded p-button-text p-button-warning p-button-lg"
              [routerLink]="['/person/registration/edit', item.id]"></button>
            <button pButton pTooltip="Excluir" icon="pi pi-trash"
              class="p-button-rounded p-button-text p-button-danger p-button-lg"></button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>

<ng-template #personTypes let-item>
  @for (type of item.types; track $index) { @switch (type) { @case ('Tarefeiro') {
  <p-tag icon="pi pi-briefcase" severity="info" value="{{ type }}"></p-tag>
  } @case ('Assistido') {
  <p-tag icon="pi pi-heart" severity="success" value="{{ type }}"></p-tag>
  } @case ('Palestrante') {
  <p-tag icon="pi pi-microphone" severity="warn" value="{{ type }}"></p-tag>
  } @case ('Entrevistador') {
  <p-tag icon="pi pi-comments" severity="secondary" value="{{ type }}"></p-tag>
  } @case ('Todos') {
  <p-tag icon="pi pi-users" severity="danger" value="{{ type }}"></p-tag>
  } @default {
  <p-tag icon="pi pi-user" severity="info" value="{{ type }}"></p-tag>
  } } }
</ng-template>
